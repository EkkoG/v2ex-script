## 注意：本脚本与其他脚本不兼容，因为本脚本会删除网页元素。

# 主要功能

- 支持回复以楼中楼的方式展示
  - 加载所有回复，保持楼中楼解析回复正确
  - 提供三种展示方式：楼中楼、按感谢排序、V2原版
  - 超过15层嵌套，默认隐藏剩余回复，点击可展开，保证嵌套过多不会导致页面变形
- 首页、节点页面，可以直接预览帖子详情
- 列表点击帖子弹出帖子详情（不跳转页面），异步加载帖子内容
- 操作按钮（感谢、收藏、回复、隐藏）异步请求，不会刷新页面
- 划词 base64 解码
- 自动加载下一页
- 自适应屏幕宽度
- 回复指定用户添加楼层号（尽管本脚本不以楼层号来解析，原因在下面。但为了保证基本脚本显示正常也默认加上）

### 关于楼中楼
- 注：其他的脚本的楼中楼回复功能。是基于当前页面做解析。如果回复没超过一页，显示正常，如果回复超过一页，楼中楼就会显示的莫名奇妙
- 注：v2的帖子详情页，打开时并不总是第一页，比如回复有3页时，打开帖子详情页展示的最后一页的回复
- 注：本脚本不以‘#楼层’ 来做解析。因为v2的回复被忽略后，会占据原来的楼层。导致按‘#楼层’解析，会出问题

# 待实现
- 自动签到
- 高亮楼主回复
- 集成 sov2ex
- 如果回复中，指定了楼层，用hover的形式显示

# 如需要其他功能或发现bug，可在[这里](https://github.com/zyronon/v2ex-script/issues)提出

https://www.v2ex.com/poll_once 好像是换once的

# 测试数据
- 362535 回复巨多
- 825072 嵌套问题
- 898448 超级多
bug
# 回复问题
- [x]  667520 嵌套有问题 
- [x]  825072 嵌套有问题 
- [x]  918489 嵌套有问题 
- [x]  724408 嵌套超级多 259 在v站单独打开帖子 失效 
- [ ]  889129 有附言的 
- [x]  890671  楼中楼不正常,70楼，回复的32楼。但是也没问题
- [x]  bug：https://greasyfork.org/zh-CN/scripts/397787-v2ex-pro/discussions/51302

# 其他问题
- [x] 点击图片无反应 https://www.v2ex.com/t/886814  备注：本来点了也没反应  
- [x]  回复自己的帖子失效 https://www.v2ex.com/t/887103 
- [x]  youtube视频不能占满 704240
- [ ]  886895 正文显示异常 开发模式显示异常，在v2ex站内显示正常
- [ ]  脚本有问题的tooltip显示不出来了
- [ ]  单独打开帖子，不自动显示的情况下，好像把body设为overflow:hidden了
- [ ]  单独打开帖子，自动显示的情况下，没有滚动到顶部

# TODO
- [ ]未登录情况下的收藏、忽略等按钮
- [x] todo 等页面分类出来了，记得把单独打开帖子时，点击忽略后要跳转到首页 
- [x] 条目点击后变灰，已读功能 
- [x] 回复时，如果是@人，那么即使显示的时候，要加上a标签 
- [x] 列表，卡片和表格间切换 
- [x] base64解码解码 https://www.v2ex.com/t/889937 
- [x] 回复按照❤️排序 
- [x] 实现回复里面@ 
- [x] 打开详情，有时候默认会跳转到最后一页 
- [x] 主贴回复 
- [x] 屏蔽预览时的 a链接点击跳转 
- [x] 解决 楼中楼全套过多的问题 887103 
- [x] 自适应屏幕宽度 
- [x] 超过15层嵌套，自动修改宽度 
- [x] 单独打开帖子,提供一个选项是否默认打开详情页 
- [x] 点赞，需要修改源数据，否则会导致楼中楼和嵌套数据不相同
- [x] 分页，可选自动翻页，还是点击后加载翻页
- [ ] 解析列表条目时，如果中间有广告，会导致获取app 下一个时是广告，而不是分页
- [ ] 点击界面上的a标签，如果是v站的，那么就弹出详情页，如果是其他，比如是video和img，要禁止
- [ ] 缓存详情数据
- [ ] 帖子详情理更像v2
- [ ] 打开详情时，地址栏显示帖子地址
- [ ] 详情页，广告无法显示的问题
- [ ] 帖子404 https://www.v2ex.com/t/855918#reply26
- [ ] 解决createNestedList 短时间内调用次数过多问题
- [ ] 新标签页打开链接
- [ ] 回复里面如果是 本站帖子，那么不打开新的页面
- [ ] 测试复制的签到功能
- [ ] 测试复制的搜索功能
- [ ] 首页自动翻页
- [ ] 详情页超过5页，不执行获取所有回复
- [ ] 读取用户，用于比较
- [ ] 适配夜间模式
- [ ] 支持多开
- [ ] 隐藏 v2ex 用户头像/页面背景
- [ ] v2ex 免跳转浏览 + 折叠回复少的页面
- [ ] v2ex屏蔽不想看到的节点
- [ ] 首页tab切换
- [ ] 支持手机版






