<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>

<body>

</body>
<script>











    window.win().cb = null

    let style = `

    
html,body{font-size:62.5%}.post-author{display:flex;align-items:center;margin-bottom:.5rem;position:relative;color:#ccc!important}.post-author>.username{font-size:1.2rem}.date{font-size:1.2rem;color:#ccc}a{color:#778087!important;text-decoration:none}a:hover{text-decoration:underline}.subtlesHtml{font-size:1.4rem}.subtlesHtml .subtle{margin-top:1rem;background-color:#fffff9;border-left:3px solid #fffbc1;padding:10px;font-size:14px;line-height:1.6;text-align:left}.subtlesHtml .subtle .fade{color:#ccc}.subtlesHtml .subtle .sep5{height:5px}.subtlesHtml .subtle .topic_content{color:#000}.base-loading{border:2px solid;border-color:#000 #00000033 #00000033 #00000033;border-radius:100%;animation:circle infinite 1s linear}.loading-c{border:2px solid;border-color:#000 #00000033 #00000033 #00000033;border-radius:100%;animation:circle infinite 1s linear;width:3rem;height:3rem}@keyframes circle{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.button{cursor:pointer;padding:.4rem 2.4rem;border-radius:10rem;display:inline-flex;justify-content:center;align-items:center;font-weight:700;font-size:1.2rem;color:#fff;background:#0079d3;border:1px solid #0079d3;user-select:none}.button:hover{opacity:.9}.button:before{content:" ";border:2px solid;border-color:#000 #00000033 #00000033 #00000033;border-radius:100%;animation:circle infinite 1s linear;border-color:#fff transparent transparent transparent;width:1rem;height:1rem;margin-right:1rem;display:none}.button.loading{cursor:not-allowed;opacity:.5}.button.loading:before{display:block}.button.disabled{cursor:not-allowed;color:#c6c6c6;background:#8d8d8d;border:1px solid transparent}.my-node{display:inline-flex;justify-content:center;align-items:center;border-radius:.6rem;height:2.2rem;padding:0 1rem;font-size:1rem;color:#fff;transform:translateY(-.3rem);background:#646d73;cursor:pointer}.msgs{position:fixed;margin-left:calc(50% - 25rem);width:50rem;z-index:9999;bottom:0;left:0;right:0}.msg{cursor:default;margin-bottom:2rem;background:white;display:flex;color:#000;font-size:1.4rem;box-sizing:border-box;border-radius:.4rem;box-shadow:0 0 1rem 1px silver}.msg.success .left{background:#0079d3}.msg.warning .left{background:#c8c002}.msg.error .left{background:red}.msg .left{border-radius:.4rem 0 0 .4rem;display:flex;align-items:center;background:#0079d3}.msg .left svg{margin:0 .3rem;cursor:pointer}.msg .right{flex:1;padding:1rem 2rem;display:flex;justify-content:space-between;align-items:center}.Author[data-v-335061d5]{display:flex;margin-bottom:.5rem;align-items:center;font-size:1.2rem;position:relative}.Author .index[data-v-335061d5]{position:absolute;right:0;font-size:1.2rem;line-height:1rem;border-radius:1rem;display:inline-block;background-color:#f0f0f0;color:#ccc;padding:.2rem .5rem;cursor:default}.Author .username[data-v-335061d5]{color:gray;font-size:1.3rem;font-weight:700}.Author .expand[data-v-335061d5]{cursor:pointer;margin-right:1rem;width:2rem;height:2rem;transform:rotate(90deg)}.Author .icon[data-v-335061d5]{margin-right:1rem;width:3rem;height:3rem;border-radius:50%}.Author .op[data-v-335061d5]{background-color:transparent;color:#1484cd;border-radius:.3rem;padding:0 .3rem;border:1px solid #1484cd;font-size:1.2rem;margin-right:1rem}.editor-wrapper[data-v-7ce8aa2e]{border-radius:.4rem;border:1px solid #dcdcdc;margin-top:1rem;margin-right:3rem;box-sizing:border-box;position:relative;overflow:hidden;transition:all .3s}.editor-wrapper.isFocus[data-v-7ce8aa2e]{border:1px solid #968b8b}.editor-wrapper .hide[data-v-7ce8aa2e]{position:absolute;left:-9999px}.editor-wrapper .post-editor[data-v-7ce8aa2e]{width:100%;max-width:100%;padding:.6rem 1.4rem;box-sizing:border-box;border:none;outline:none;font-family:Avenir,Helvetica,Arial,sans-serif;font-size:1.4rem;min-height:13rem}.editor-wrapper .toolbar[data-v-7ce8aa2e]{box-sizing:border-box;text-align:end;padding:.5rem 1rem;width:100%;position:relative;background:#f6f7f8}.horizontal[data-v-009da0a8]{flex-direction:row!important;padding:0!important}.horizontal .num[data-v-009da0a8]{margin-left:.2rem}.point[data-v-009da0a8]{font-size:1.2rem;padding:1rem 0;min-width:4rem;border-radius:.4rem 0 0 .4rem;display:flex;flex-direction:column;align-items:center}.point .up[data-v-009da0a8]{display:flex;flex-direction:column;align-items:center;justify-content:center}.point .num[data-v-009da0a8]{font-weight:700;color:#000}.point svg[data-v-009da0a8]{width:2rem;padding:.4rem;border-radius:.2rem}.point svg[data-v-009da0a8]:hover{background:#e5e5e5}.point .disabled[data-v-009da0a8]:hover{background:unset}.comment[data-v-1708e0f1]{width:100%;box-sizing:border-box;padding-left:.6rem;margin-top:2rem}.comment .content[data-v-1708e0f1]{display:flex;position:relative}.comment .content .line[data-v-1708e0f1]{cursor:pointer;border-right:2px solid #ddd;width:1.3rem}.comment .content .line[data-v-1708e0f1]:hover{border-right:2px solid #0079D3}.comment .content .right[data-v-1708e0f1]{flex:1;width:calc(100% - 1.5rem)}.comment .content .right .w[data-v-1708e0f1]{padding-left:2.4rem}.comment .content .right .w .text[data-v-1708e0f1]{color:#000;word-break:break-word}.comment .content .right .w .toolbar[data-v-1708e0f1]{margin-top:.5rem;display:flex;align-items:center;color:#929596}.comment .content .right .w .toolbar .tool[data-v-1708e0f1]{margin:0 .4rem;cursor:pointer;height:3.2rem;display:flex;align-items:center;justify-content:center;font-size:1.2rem;font-weight:700;border-radius:.2rem}.comment .content .right .w .toolbar .tool>svg[data-v-1708e0f1]{width:2rem;padding:.4rem .6rem;border-radius:.2rem}.comment .content .right .w .toolbar .tool span[data-v-1708e0f1]{margin:0 .4rem}.comment .content .right .w .toolbar .tool:nth-child(2) span[data-v-1708e0f1]{margin:0;margin-right:.6rem}.comment .content .right .w .toolbar .tool[data-v-1708e0f1]:hover{background:#e8e8e8}.toolbar[data-v-a9c8d246]{display:flex;align-items:center;color:#929596}.toolbar .tool[data-v-a9c8d246]{position:relative;margin-right:.4rem;display:flex;align-items:center;font-size:1rem;font-weight:700;border-radius:.2rem;cursor:pointer}.toolbar .tool>svg[data-v-a9c8d246]{width:2rem;padding:.6rem;border-radius:.2rem}.toolbar .tool span[data-v-a9c8d246]{margin-right:.6rem}.toolbar .tool[data-v-a9c8d246]:hover{background:#e8e8e8}.toolbar .tool.no-hover[data-v-a9c8d246]{cursor:default}.toolbar .tool.no-hover[data-v-a9c8d246]:hover{background:unset}.toolbar .tooltip[data-v-a9c8d246]{box-shadow:0 3px 6px -4px #0000001f,0 6px 16px #00000014,0 9px 28px 8px #0000000d;background:white;padding:1rem;bottom:4rem;left:-3rem;width:15rem;position:absolute}.toolbar .tooltip a[data-v-a9c8d246]{color:#0079d3!important}.htmlContent{width:100%}.htmlContent img{max-width:100%}.detail[data-v-4a2c24fd]{text-align:start;position:fixed;z-index:99;left:0;right:0;bottom:0;top:0;background:rgba(46,47,48,.8);overflow:auto;font-size:1.4rem}.detail .main[data-v-4a2c24fd]{padding:6rem 15rem;display:flex;margin:auto;width:55vw;box-sizing:border-box;min-height:100%;background:#dae0e6}.detail .main>.left[data-v-4a2c24fd]{flex:1;max-width:100%;background:white;border-radius:.4rem;padding-bottom:2rem;display:flex;flex-direction:column;align-items:center}.detail .main>.left .post[data-v-4a2c24fd]{width:100%;display:flex}.detail .main>.left .post .right[data-v-4a2c24fd]{box-sizing:border-box;width:calc(100% - 4rem);flex:1;padding:1rem;padding-left:0}.detail .main>.left .post .right .avatar[data-v-4a2c24fd]{float:right}.detail .main>.left .post .right .avatar img[data-v-4a2c24fd]{width:6.4rem}.detail .main>.left .post .right .tags[data-v-4a2c24fd]{margin-bottom:1rem}.detail .main>.left .post .right .title[data-v-4a2c24fd]{margin-bottom:1rem;line-height:150%;font-size:2rem;color:#000}.detail .main>.left .post .right .content[data-v-4a2c24fd]{color:#000;word-break:break-word;line-height:1.6;margin:1rem 0}.detail .main>.left .loading-w[data-v-4a2c24fd]{height:30rem;display:flex;justify-content:center;align-items:center}.detail .main>.left .line[data-v-4a2c24fd]{border-bottom:1px solid #dcdcdc;width:91%;margin:2rem}.detail .main>.left .comments[data-v-4a2c24fd]{width:100%;box-sizing:border-box;padding-right:1rem}.detail .main>.left .empty[data-v-4a2c24fd]{color:#ccc;font-weight:400;height:30rem;display:flex;flex-direction:column;align-items:center;justify-content:center}.detail .main>.left .empty div[data-v-4a2c24fd]{margin-top:2rem}.detail .main>.left .empty .t1[data-v-4a2c24fd]{font-size:1.6rem;font-weight:700}@media screen and (max-width: 1500px){.detail .main[data-v-4a2c24fd]{padding:8rem;width:70vw}}@media screen and (max-width: 1280px){.detail .main[data-v-4a2c24fd]{padding:5rem;width:75vw}}.detail .scroll-top[data-v-4a2c24fd]{position:fixed;right:5%;bottom:10%}p:first-child{margin-top:0}p:last-child{margin-bottom:0}.post[data-v-5bb61d40]{font-size:1.4rem;display:flex;cursor:pointer;background:white;margin-top:1.1rem;border:1px solid #dcdcdc;border-radius:.4rem;text-align:start}.post[data-v-5bb61d40]:hover{border:1px solid #968b8b}.post .right[data-v-5bb61d40]{padding:.4rem 1rem;width:calc(100% - 4rem);box-sizing:border-box}.post .right .title[data-v-5bb61d40]{display:inline;align-items:center}.post .right .title span[data-v-5bb61d40]{color:#000!important;font-size:2rem;margin-left:.5rem}.post .right .content[data-v-5bb61d40]{color:#000;max-height:25rem;overflow:hidden;position:relative;padding:1rem 0}.post .right .content.mask[data-v-5bb61d40]{-webkit-mask-image:linear-gradient(180deg,#000 60%,transparent)}

 
    


    `
    let addStyle = document.createElement("style");
    addStyle.rel = "stylesheet";
    addStyle.type = "text/css";
    addStyle.innerHTML = style
    document.head.append(addStyle)

    let $vue = document.createElement('script')
    $vue.src = 'https://cdn.bootcdn.net/ajax/libs/vue/3.2.40/vue.global.min.js'
    document.body.appendChild($vue);
    $vue.addEventListener('load', () => {


const M=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function e(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(n){if(n.ep)return;n.ep=!0;const s=e(n);fetch(n.href,s)}};M();var k=(o,t)=>{const e=o.__vccOpts||o;for(const[l,n]of t)e[l]=n;return e};const L={name:"Author",components:{},props:{modelValue:!1,comment:{type:Object,default(){return{}}}},data(){return{}},watch:{},created(){},methods:{}},C=o=>(Vue.pushScopeId("data-v-335061d5"),o=o(),Vue.popScopeId(),o),S={class:"Author"},H=C(()=>Vue.createElementVNode("path",{d:"M22 42H6V26",stroke:"#177EC9","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),I=C(()=>Vue.createElementVNode("path",{d:"M26 6H42V22",stroke:"#177EC9","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),R=[H,I],D=["href"],F=["src"],P={class:"username"},A=["href"],j={key:1,class:"op"},O={class:"date"},U={class:"index"};function q(o,t,e,l,n,s){return Vue.openBlock(),Vue.createElementBlock("div",S,[e.modelValue?Vue.createCommentVNode("",!0):(Vue.openBlock(),Vue.createElementBlock("svg",{key:0,class:"expand",onClick:t[0]||(t[0]=r=>o.$emit("update:modelValue",!0)),width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},R)),Vue.createElementVNode("a",{href:`/member/${e.comment.username}`},[Vue.createElementVNode("img",{class:"icon",src:e.comment.avatar,alt:""},null,8,F)],8,D),Vue.createElementVNode("div",P,[Vue.createElementVNode("a",{href:`/member/${e.comment.username}`},Vue.toDisplayString(e.comment.username),9,A)]),Vue.createTextVNode(" \xA0\xA0\xA0 "),e.comment.isOp?(Vue.openBlock(),Vue.createElementBlock("div",j,"OP")):Vue.createCommentVNode("",!0),Vue.createElementVNode("div",O,Vue.toDisplayString(e.comment.date),1),Vue.createElementVNode("div",U,Vue.toDisplayString(e.comment.index),1)])}var z=k(L,[["render",q],["__scopeId","data-v-335061d5"]]),a={eventMap:new Map,on(o,t){let e=this.eventMap.get(o);e?e.push(t):e=[t],this.eventMap.set(o,e)},emit(o,t){let e=this.eventMap.get(o);e&&e.map(l=>l(t))},off(o){this.eventMap.has(o)&&this.eventMap.delete(o)}};const Z={name:"PostEditor",props:{replyInfo:{type:String,default(){return""}}},inject:["postUsername","replyCount","postId","once"],data(){return{isFocus:!1,editorId:"editorId_"+Date.now(),content:this.replyInfo,loading:!1}},methods:{async submit(){if(!this.content||this.loading)return;this.loading=!0;let o={thankCount:0,isThanked:!1,isOp:this.postUsername===window.win().user.username,id:Date.now(),username:window.win().user.username,avatar:window.win().user.avatar,date:"\u51E0\u79D2\u524D",index:this.replyCount+1,reply_content:this.content||Date.now(),children:[]};this.loading=!1,a.emit("refreshOnce"),a.emit("msg",{type:"success",text:"\u56DE\u590D\u6210\u529F"}),a.emit("addReply",o),this.$emit("addReplyChild",o),this.content=this.replyInfo}},mounted(){$(`.${this.editorId}`).each(function(){this.setAttribute("style","height:"+this.scrollHeight+"px;overflow-y:hidden;")}).on("input",function(){this.style.height=0,this.style.height=this.scrollHeight+"px"}),this.$refs.txt.focus()},beforeUnmount(){$(`.${this.editorId}`).off()}},J={class:"toolbar"};function K(o,t,e,l,n,s){return Vue.openBlock(),Vue.createElementBlock("div",{class:Vue.normalizeClass(["editor-wrapper",{isFocus:n.isFocus}])},[Vue.withDirectives(Vue.createElementVNode("textarea",{class:Vue.normalizeClass(["post-editor",n.editorId]),ref:"txt",onFocus:t[0]||(t[0]=r=>n.isFocus=!0),onBlur:t[1]||(t[1]=r=>n.isFocus=!1),"onUpdate:modelValue":t[2]||(t[2]=r=>n.content=r)},null,34),[[Vue.vModelText,n.content]]),Vue.createElementVNode("textarea",{class:Vue.normalizeClass(["hide",n.editorId])},null,2),Vue.createElementVNode("div",J,[Vue.createElementVNode("div",{class:Vue.normalizeClass(["button",{disabled:!n.content,loading:n.loading}]),onClick:t[3]||(t[3]=(...r)=>s.submit&&s.submit(...r))},"\u56DE\u590D ",2)])],2)}var E=k(Z,[["render",K],["__scopeId","data-v-7ce8aa2e"]]);const G={name:"Point",inject:["once"],props:{item:{type:Object,default(){return{}}},type:{type:String,default(){return"horizontal"}},apiUrl:""},computed:{disabled(){return this.item.username===window.win().user.username||this.item.isThanked}},methods:{async thank(){if(!this.once||this.disabled)return;this.$emit("addThank");let o=`${window.url}/thank/${this.apiUrl}?once=${this.once}`;$.post(o).then(t=>{console.log("\u611F\u8C22",t),t.success?a.emit("refreshOnce",t.once):(this.$emit("recallThank"),a.emit("msg",{type:"error",text:t.message}))},t=>{this.$emit("recallThank"),a.emit("msg",{type:"error",text:"\u611F\u8C22\u5931\u8D25"})})}}},x=o=>(Vue.pushScopeId("data-v-009da0a8"),o=o(),Vue.popScopeId(),o),Q=x(()=>Vue.createElementVNode("path",{d:"M5 24L24 6L43 24H31V42H17V24H5Z",fill:"none",stroke:"#ff4500","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),W=[Q],X=x(()=>Vue.createElementVNode("path",{d:"M5 24L24 6L43 24H31V42H17V24H5Z",fill:"none",stroke:"#9b9b9b","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),Y=[X],ee={class:"num"};function te(o,t,e,l,n,s){return Vue.openBlock(),Vue.createElementBlock("div",{class:Vue.normalizeClass(["point",e.type])},[Vue.createElementVNode("div",{class:"up",onClick:t[0]||(t[0]=Vue.withModifiers((...r)=>s.thank&&s.thank(...r),["stop"]))},[Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("svg",{class:Vue.normalizeClass({disabled:s.disabled}),width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},W,2)),[[Vue.vShow,e.item.isThanked]]),Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("svg",{class:Vue.normalizeClass({disabled:s.disabled}),width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Y,2)),[[Vue.vShow,!e.item.isThanked]])]),Vue.createElementVNode("div",ee,Vue.toDisplayString(e.item.thankCount?e.item.thankCount:"\u611F\u8C22"),1)],2)}var y=k(G,[["render",te],["__scopeId","data-v-009da0a8"]]);const oe={name:"Comment",components:{Author:z,PostEditor:E,Point:y},props:{modelValue:{reply_content:""}},data(){return{edit:!1,expand:!0,replyInfo:`@${this.modelValue.username} #${this.modelValue.index} `}},inject:["once"],watch:{},created(){},methods:{addThank(){this.modelValue.isThanked=!0,this.modelValue.thankCount++},recallThank(){this.modelValue.isThanked=!1,this.modelValue.thankCount--},hide(){let o=`${window.url}/ignore/reply/${this.modelValue.id}?once=${this.once}`;this.$emit("remove",this.modelValue.id),$.post(o).then(t=>{console.log("hide\uFF1A",t),a.emit("refreshOnce"),a.emit("msg",{type:"success",text:"\u9690\u85CF\u6210\u529F"})},t=>{a.emit("msg",{type:"warning",text:"\u9690\u85CF\u6210\u529F,\u4EC5\u672C\u6B21\u6709\u6548\uFF08\u63A5\u53E3\u8C03\u7528\u5931\u8D25\uFF01\uFF09"})})},remove(o){let t=this.modelValue.children.findIndex(e=>e.id===o);t>-1&&this.modelValue.children.splice(t,1)},toggle(){this.expand=!this.expand},addReplyChild(o){this.edit=!1,this.modelValue.children.push(o)}}},ne=o=>(Vue.pushScopeId("data-v-1708e0f1"),o=o(),Vue.popScopeId(),o),se={class:"comment"},le={class:"content"},re={class:"right"},ie={class:"w"},ae=["innerHTML"],de={class:"toolbar"},ce=Vue.createStaticVNode('<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-1708e0f1><path d="M4 6H44V36H29L24 41L19 36H4V6Z" fill="none" stroke="#929596" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1708e0f1></path><path d="M23 21H25.0025" stroke="#929596" stroke-width="2" stroke-linecap="round" data-v-1708e0f1></path><path d="M33.001 21H34.9999" stroke="#929596" stroke-width="2" stroke-linecap="round" data-v-1708e0f1></path><path d="M13.001 21H14.9999" stroke="#929596" stroke-width="2" stroke-linecap="round" data-v-1708e0f1></path></svg><span data-v-1708e0f1>\u56DE\u590D</span>',2),ue=[ce],he=ne(()=>Vue.createElementVNode("span",null,"\u9690\u85CF",-1)),me=[he],pe={class:"my-wrapper"};function Ve(o,t,e,l,n,s){const r=Vue.resolveComponent("Author"),h=Vue.resolveComponent("Point"),m=Vue.resolveComponent("PostEditor"),d=Vue.resolveComponent("Comment",!0);return Vue.openBlock(),Vue.createElementBlock("div",se,[Vue.createVNode(r,{modelValue:n.expand,"onUpdate:modelValue":t[0]||(t[0]=i=>n.expand=i),comment:e.modelValue},null,8,["modelValue","comment"]),Vue.withDirectives(Vue.createElementVNode("div",le,[Vue.createElementVNode("div",{class:"left line",onClick:t[1]||(t[1]=(...i)=>s.toggle&&s.toggle(...i))}),Vue.createElementVNode("div",re,[Vue.createElementVNode("div",ie,[Vue.createElementVNode("div",{class:"text",innerHTML:e.modelValue.reply_content},null,8,ae),Vue.createElementVNode("div",de,[Vue.createVNode(h,{item:{isThanked:e.modelValue.isThanked,thankCount:e.modelValue.thankCount,username:e.modelValue.username},onAddThank:s.addThank,onRecallThank:s.recallThank,"api-url":"reply/"+e.modelValue.id},null,8,["item","onAddThank","onRecallThank","api-url"]),Vue.createElementVNode("div",{class:"tool",onClick:t[2]||(t[2]=i=>n.edit=!n.edit)},ue),Vue.createElementVNode("div",{class:"tool",onClick:t[3]||(t[3]=(...i)=>s.hide&&s.hide(...i))},me)]),Vue.createElementVNode("div",pe,[n.edit?(Vue.openBlock(),Vue.createBlock(m,{key:0,replyInfo:n.replyInfo,onAddReplyChild:s.addReplyChild},null,8,["replyInfo","onAddReplyChild"])):Vue.createCommentVNode("",!0)])]),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.modelValue.children,(i,V)=>(Vue.openBlock(),Vue.createBlock(d,{modelValue:e.modelValue.children[V],"onUpdate:modelValue":f=>e.modelValue.children[V]=f,onRemove:s.remove,key:V},null,8,["modelValue","onUpdate:modelValue","onRemove"]))),128))])],512),[[Vue.vShow,n.expand]])])}var _e=k(oe,[["render",Ve],["__scopeId","data-v-1708e0f1"]]);const fe={name:"Toolbar",props:{post:{type:Object,default(){return{}}},replyCount:0},data(){return{timer:null,showTooltip:!1,showMoreTool:!1}},methods:{showTooltipHandler(){this.timer&&clearTimeout(this.timer),this.showTooltip=!0},hideTooltip(){this.timer=setTimeout(()=>{this.showTooltip=!1},500)},tweet(){let o="asdf",t=`https://twitter.com/share?url=${window.url}/t/${this.post.id}?r=${o}&amp;related=v2ex&amp;hashtags=apple&amp;text=${this.post.title}`;window.open(t,"_blank","width=550,height=370")},hide(){let o=`${window.url}/ignore/topic/${this.post.id}?once=${this.post.once}`;a.emit("ignore"),$.get(o).then(t=>{console.log(t),a.emit("refreshOnce",t.once),a.emit("msg",{type:"success",text:"\u5FFD\u7565\u6210\u529F"})},t=>{a.emit("msg",{type:"warning",text:"\u5FFD\u7565\u6210\u529F,\u4EC5\u672C\u6B21\u6709\u6548\uFF08\u63A5\u53E3\u8C03\u7528\u5931\u8D25\uFF01\uFF09"})})},toggleFavorite(){let o=`${window.url}/favorite/topic/${this.post.id}?once=${this.post.once}`;$.post(o).then(t=>{console.log(t),t.success?(a.emit("merge","isFavorite"),a.emit("refreshOnce",t.once),a.emit("msg",{type:"success",text:"\u6536\u85CF\u6210\u529F"})):a.emit("msg",{type:"error",text:"\u6536\u85CF\u5931\u8D25"})},t=>{a.emit("msg",{type:"error",text:"\u6536\u85CF\u5931\u8D25"})})}}},v=o=>(Vue.pushScopeId("data-v-a9c8d246"),o=o(),Vue.popScopeId(),o),ke={class:"toolbar"},ve=Vue.createStaticVNode('<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-a9c8d246><path d="M4 6H44V36H29L24 41L19 36H4V6Z" fill="none" stroke="#929596" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-a9c8d246></path><path d="M23 21H25.0025" stroke="#929596" stroke-width="2" stroke-linecap="round" data-v-a9c8d246></path><path d="M33.001 21H34.9999" stroke="#929596" stroke-width="2" stroke-linecap="round" data-v-a9c8d246></path><path d="M13.001 21H14.9999" stroke="#929596" stroke-width="2" stroke-linecap="round" data-v-a9c8d246></path></svg>',1),ge=v(()=>Vue.createElementVNode("svg",{width:"20",height:"20",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[Vue.createElementVNode("path",{d:"M34 10V4H8V38L14 35",stroke:"#929596","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),Vue.createElementVNode("path",{d:"M14 44V10H40V44L27 37.7273L14 44Z",fill:"none",stroke:"#929596","stroke-width":"2","stroke-linejoin":"round"})],-1)),we=v(()=>Vue.createElementVNode("svg",{width:"20",height:"20",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[Vue.createElementVNode("path",{d:"M28 6H42V20",stroke:"#929596","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),Vue.createElementVNode("path",{d:"M42 29.4737V39C42 40.6569 40.6569 42 39 42H9C7.34315 42 6 40.6569 6 39V9C6 7.34315 7.34315 6 9 6L18 6",stroke:"#929596","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),Vue.createElementVNode("path",{d:"M25.7998 22.1999L41.0998 6.8999",stroke:"#929596","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),ye=v(()=>Vue.createElementVNode("span",null,"Tweet",-1)),Ne=[we,ye],Ce=v(()=>Vue.createElementVNode("svg",{width:"20",height:"20",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[Vue.createElementVNode("path",{d:"M9.85786 18C6.23858 21 4 24 4 24C4 24 12.9543 36 24 36C25.3699 36 26.7076 35.8154 28 35.4921M20.0318 12.5C21.3144 12.1816 22.6414 12 24 12C35.0457 12 44 24 44 24C44 24 41.7614 27 38.1421 30",stroke:"#929596","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),Vue.createElementVNode("path",{d:"M20.3142 20.6211C19.4981 21.5109 19 22.6972 19 23.9998C19 26.7612 21.2386 28.9998 24 28.9998C25.3627 28.9998 26.5981 28.4546 27.5 27.5705",stroke:"#929596","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),Vue.createElementVNode("path",{d:"M42 42L6 6",stroke:"#929596","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),Ee=v(()=>Vue.createElementVNode("span",null,"\u5FFD\u7565\u4E3B\u9898",-1)),xe=[Ce,Ee],Te=v(()=>Vue.createElementVNode("a",{target:"_blank",href:"https://github.com/zyronon/"},"\u70B9\u51FB\u8FD9\u91CC\u63D0\u4E00\u4E2AIssue",-1)),be=v(()=>Vue.createElementVNode("svg",{width:"20",height:"20",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[Vue.createElementVNode("path",{d:"M8 44H12H16",stroke:"#929596","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),Vue.createElementVNode("path",{d:"M12 44V4",stroke:"#929596","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),Vue.createElementVNode("path",{d:"M40 6H12V22H40L36 14L40 6Z",fill:"none",stroke:"#929596","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),Be=v(()=>Vue.createElementVNode("span",null,"\u811A\u672C\u6709\u95EE\u9898\uFF1F",-1));function Me(o,t,e,l,n,s){return Vue.openBlock(),Vue.createElementBlock("div",ke,[Vue.createElementVNode("div",{class:Vue.normalizeClass(["tool",e.post.once?"no-hover":""])},[ve,Vue.createElementVNode("span",null,Vue.toDisplayString(e.replyCount)+"\u6761\u56DE\u590D",1)],2),e.post.once?(Vue.openBlock(),Vue.createElementBlock("div",{key:0,class:"tool",onClick:t[0]||(t[0]=(...r)=>s.toggleFavorite&&s.toggleFavorite(...r))},[ge,Vue.createElementVNode("span",null,Vue.toDisplayString(e.post.isFavorite?"\u53D6\u6D88\u6536\u85CF":"\u52A0\u5165\u6536\u85CF"),1)])):Vue.createCommentVNode("",!0),Vue.createElementVNode("div",{class:"tool",onClick:t[1]||(t[1]=(...r)=>s.tweet&&s.tweet(...r))},Ne),e.post.once?(Vue.openBlock(),Vue.createElementBlock("div",{key:1,class:"tool",onClick:t[2]||(t[2]=(...r)=>s.hide&&s.hide(...r))},xe)):Vue.createCommentVNode("",!0),e.post.once?(Vue.openBlock(),Vue.createElementBlock("div",{key:2,class:"tool no-hover",onMouseenter:t[5]||(t[5]=(...r)=>s.showTooltipHandler&&s.showTooltipHandler(...r)),onMouseleave:t[6]||(t[6]=(...r)=>s.hideTooltip&&s.hideTooltip(...r))},[n.showTooltip?(Vue.openBlock(),Vue.createElementBlock("div",{key:0,class:"tooltip",onMouseenter:t[3]||(t[3]=(...r)=>s.showTooltipHandler&&s.showTooltipHandler(...r)),onMouseleave:t[4]||(t[4]=(...r)=>s.hideTooltip&&s.hideTooltip(...r))},[Vue.createTextVNode(" \u811A\u672C\u6709\u95EE\u9898\uFF1F"),Te],32)):Vue.createCommentVNode("",!0),be,Be],32)):Vue.createCommentVNode("",!0)])}var T=k(fe,[["render",Me],["__scopeId","data-v-a9c8d246"]]);const Le={name:"detail",components:{Comment:_e,PostEditor:E,Point:y,Toolbar:T},provide(){return{postUsername:Vue.computed(()=>this.post.username),postTitle:Vue.computed(()=>this.post.title),postId:Vue.computed(()=>this.post.id),once:Vue.computed(()=>this.post.once),replyCount:Vue.computed(()=>this.post.replyCount)}},props:{modelValue:!1,loading:!1,post:{type:Object,default(){return{}}}},data(){return{}},computed:{},watch:{modelValue(o){o?document.body.style.overflow="hidden":(this.$refs.detail.scrollTo({top:0}),document.body.style.overflow="unset")}},created(){},mounted(){},methods:{addThank(){this.post.isThanked=!0,this.post.thankCount++},recallThank(){this.post.isThanked=!1,this.post.thankCount--},remove(o){this.post.nestedReplies.splice(o,1)},addReplyChild(o){this.post.nestedReplies.push(o)},scrollTop(){this.$refs.detail.scrollTo({top:0,behavior:"smooth"})}}},b=o=>(Vue.pushScopeId("data-v-4a2c24fd"),o=o(),Vue.popScopeId(),o),Se={class:"left"},He={class:"post"},Ie={class:"right"},$e=["href"],Re={class:"avatar"},De=["src"],Fe={class:"post-author"},Pe={class:"username"},Ae=["href"],je={class:"date"},Oe={class:"date"},Ue=["innerHTML"],qe={key:0,class:"my-node"},ze={class:"content"},Ze=["innerHTML"],Je=["innerHTML"],Ke=b(()=>Vue.createElementVNode("div",{class:"line"},null,-1)),Ge={key:0,class:"loading-w"},Qe=b(()=>Vue.createElementVNode("div",{class:"loading-c"},null,-1)),We=[Qe],Xe={key:0,class:"comments"},Ye={key:1,class:"empty"},et=Vue.createStaticVNode('<svg width="20" height="20" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-4a2c24fd><path d="M4 6H44V36H29L24 41L19 36H4V6Z" fill="#4a90e2" stroke="#4a90e2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-4a2c24fd></path><path d="M23 21H25.0025" stroke="#FFF" stroke-width="2" stroke-linecap="round" data-v-4a2c24fd></path><path d="M33.001 21H34.9999" stroke="#FFF" stroke-width="2" stroke-linecap="round" data-v-4a2c24fd></path><path d="M13.001 21H14.9999" stroke="#FFF" stroke-width="2" stroke-linecap="round" data-v-4a2c24fd></path></svg><div class="t1" data-v-4a2c24fd> \u6682\u65E0\u8BC4\u8BBA </div><div data-v-4a2c24fd> \u7B2C\u4E00\u4E2A\u5206\u4EAB\u4F60\u7684\u60F3\u6CD5\uFF01 </div>',3),tt=[et];function ot(o,t,e,l,n,s){const r=Vue.resolveComponent("Point"),h=Vue.resolveComponent("Toolbar"),m=Vue.resolveComponent("PostEditor"),d=Vue.resolveComponent("Comment");return Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",{class:"detail",ref:"detail",onClick:t[2]||(t[2]=i=>o.$emit("update:modelValue",!1))},[Vue.createElementVNode("div",{class:"main",onClick:t[0]||(t[0]=Vue.withModifiers((...i)=>o.stop&&o.stop(...i),["stop"]))},[Vue.createElementVNode("div",Se,[Vue.createElementVNode("div",He,[Vue.createVNode(r,{onAddThank:s.addThank,onRecallThank:s.recallThank,item:{isThanked:e.post.isThanked,thankCount:e.post.thankCount,username:e.post.username},type:"vertical","api-url":"topic/"+e.post.id},null,8,["onAddThank","onRecallThank","item","api-url"]),Vue.createElementVNode("div",Ie,[Vue.createElementVNode("a",{href:`/member/${e.post.username}`},[Vue.createElementVNode("div",Re,[Vue.createElementVNode("img",{src:e.post.avatar,alt:""},null,8,De)])],8,$e),Vue.createElementVNode("div",Fe,[Vue.createElementVNode("div",Pe,[Vue.createElementVNode("a",{href:`/member/${e.post.username}`},Vue.toDisplayString(e.post.username),9,Ae)]),Vue.createTextVNode(" \xA0\xA0\xB7\xA0\xA0 "),Vue.createElementVNode("div",je,Vue.toDisplayString(e.post.date),1),Vue.createTextVNode(" \xA0\xA0\xB7\xA0\xA0 "),Vue.createElementVNode("div",Oe,Vue.toDisplayString(e.post.clickCount)+"\u6B21\u70B9\u51FB",1)]),Vue.createElementVNode("div",{class:"title",innerHTML:e.post.title},null,8,Ue),e.post.node?(Vue.openBlock(),Vue.createElementBlock("div",qe,Vue.toDisplayString(e.post.node),1)):Vue.createCommentVNode("",!0),Vue.createElementVNode("div",ze,[Vue.createElementVNode("div",{innerHTML:e.post.content_rendered,class:"htmlContent"},null,8,Ze),Vue.createElementVNode("div",{innerHTML:e.post.subtlesHtml},null,8,Je)]),Vue.createVNode(h,{post:e.post,replyCount:e.post.replyCount},null,8,["post","replyCount"]),e.modelValue?(Vue.openBlock(),Vue.createBlock(m,{key:1,onAddReplyChild:s.addReplyChild},null,8,["onAddReplyChild"])):Vue.createCommentVNode("",!0)])]),Ke,e.loading?(Vue.openBlock(),Vue.createElementBlock("div",Ge,We)):(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:1},[e.post.nestedReplies.length?(Vue.openBlock(),Vue.createElementBlock("div",Xe,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.post.nestedReplies,(i,V)=>(Vue.openBlock(),Vue.createBlock(d,{onRemove:f=>s.remove(V),modelValue:e.post.nestedReplies[V],"onUpdate:modelValue":f=>e.post.nestedReplies[V]=f,key:V},null,8,["onRemove","modelValue","onUpdate:modelValue"]))),128))])):(Vue.openBlock(),Vue.createElementBlock("div",Ye,tt))],64))])]),Vue.createElementVNode("div",{class:"scroll-top button",onClick:t[1]||(t[1]=Vue.withModifiers((...i)=>s.scrollTop&&s.scrollTop(...i),["stop"]))}," \u56DE\u5230\u9876\u90E8 ")],512)),[[Vue.vShow,e.modelValue]])}var nt=k(Le,[["render",ot],["__scopeId","data-v-4a2c24fd"]]);const st={name:"post",props:{post:{type:Object,default(){return{}}}},components:{Toolbar:T,Point:y},data(){return{mask:!1}},watch:{"post.content_rendered"(o){this.$nextTick(()=>{if(!this.$refs.content)return;let t=this.$refs.content.getBoundingClientRect();this.mask=t.height>250})}},created(){},mounted(){},methods:{}},lt={class:"post"},rt={class:"right"},it={class:"post-author"},at={class:"username"},dt=["href"],ct={class:"date"},ut={class:"title"},ht={class:"my-node"},mt=["innerHTML"];function pt(o,t,e,l,n,s){const r=Vue.resolveComponent("Toolbar");return Vue.openBlock(),Vue.createElementBlock("div",lt,[Vue.createElementVNode("div",rt,[Vue.createElementVNode("div",it,[Vue.createElementVNode("div",at,[Vue.createElementVNode("a",{href:`/member/${e.post.username}`},Vue.toDisplayString(e.post.username),9,dt)]),Vue.createTextVNode(" \xA0\xA0\xA0 "),Vue.createElementVNode("div",ct,Vue.toDisplayString(e.post.date),1)]),Vue.createElementVNode("div",ut,[Vue.createElementVNode("div",ht,Vue.toDisplayString(e.post.node),1),Vue.createElementVNode("span",null,Vue.toDisplayString(e.post.title),1)]),e.post.content_rendered?(Vue.openBlock(),Vue.createElementBlock("div",{key:0,class:Vue.normalizeClass(["content",{mask:n.mask}]),ref:"content"},[Vue.createElementVNode("div",{innerHTML:e.post.content_rendered},null,8,mt)],2)):Vue.createCommentVNode("",!0),Vue.createVNode(r,{post:e.post,"reply-count":e.post.replyCount},null,8,["post","reply-count"])])])}var Vt=k(st,[["render",pt],["__scopeId","data-v-5bb61d40"]]);const _t={name:"Msg",props:{type:"",text:""},created(){setTimeout(()=>{this.$emit("close")},3e3)}},ft=Vue.createElementVNode("svg",{width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[Vue.createElementVNode("path",{d:"M14 14L34 34",stroke:"#ffffff","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"}),Vue.createElementVNode("path",{d:"M14 34L34 14",stroke:"#ffffff","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"})],-1),kt=[ft],vt={class:"right"};function gt(o,t,e,l,n,s){return Vue.openBlock(),Vue.createElementBlock("div",{class:Vue.normalizeClass(["msg",e.type])},[Vue.createElementVNode("div",{class:"left",onClick:t[0]||(t[0]=r=>o.$emit("close"))},kt),Vue.createElementVNode("div",vt,Vue.toDisplayString(e.text),1)],2)}var wt=k(_t,[["render",gt]]),yt=[{avatar:"https://cdn.v2ex.com/avatar/cdca/41db/41900_normal.png?m=1644293935",id:"825072",title:"\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898",node:"\u7ECF\u5178\u56DE\u987E",username:"\u7ECF\u5178\u56DE\u987E",date:"\u51E0\u5C0F\u65F6\u524D"},{avatar:"https://cdn.v2ex.com/avatar/cdca/41db/41900_normal.png?m=1644293935",id:"724408",title:"\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898",node:"\u7ECF\u5178\u56DE\u987E",username:"\u7ECF\u5178\u56DE\u987E",date:"\u51E0\u5C0F\u65F6\u524D"},{avatar:"https://cdn.v2ex.com/avatar/cdca/41db/41900_normal.png?m=1644293935",id:"667520",content_rendered:'<a target="_self" href="/t/886895" rel="nofollow noopener"  >/t/886895</a>',title:"\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898\u6700\u8FD1\u7F51\u4E0A\u8BA8\u8BBA\u5F88\u591A\u7684\u82F9\u679C\u5907\u5FD8\u5F55\u4E22\u5931\u95EE\u9898",node:"\u7ECF\u5178\u56DE\u987E",username:"\u7ECF\u5178\u56DE\u987E",date:"\u51E0\u5C0F\u65F6\u524D"},{avatar:"https://cdn.v2ex.com/avatar/cdca/41db/41900_normal.png?m=1644293935",id:"886622",title:"\u56DE\u590D\u91CC\u9762\u5982\u679C\u662F \u672C\u7AD9\u5E16\u5B50\uFF0C\u90A3\u4E48\u4E0D\u6253\u5F00\u65B0\u7684\u9875\u9762",node:"\u7ECF\u5178\u56DE\u987E",username:"\u7ECF\u5178\u56DE\u987E",date:"\u51E0\u5C0F\u65F6\u524D"}];let w=[];const Nt={name:"home",components:{PostDetail:nt,Post:Vt,Msg:wt},data(){return{loading:!1,msgList:[],show:!1,current:{replies:[],nestedReplies:[]},list:[]}},computed:{isDev(){return!0}},watch:{show(o){o||window.history.back()}},created(){let o=this;window.win().cb=l=>{l.map(n=>{let s=o.list.findIndex(r=>r.id==n.id);s>-1&&(o.list[s]=Object.assign(o.list[s],{content_rendered:n.content_rendered,replyCount:n.replies||0,nodeUrl:n.node.url,avatar:n.member.avatar_large}))})},window.postList&&(this.list=window.postList),this.isDev&&(this.list=yt),a.on("msg",l=>{this.msgList.push({...l,id:Date.now()})}),a.on("ignore",()=>{this.show=!1;let l=this.list.findIndex(n=>n.id===this.current.id);l>-1&&this.list.splice(l,1),this.current={replies:[],nestedReplies:[]}}),a.on("merge",l=>{let n=this.list.findIndex(s=>s.id===this.current.id);n>-1&&(this.list[n][l]=!this.list[n][l],this.current[l]=!this.current[l])}),a.on("addReply",l=>{this.current.replies.push(l);let n=this.list.findIndex(s=>s.id===this.current.id);n>-1&&(this.current.replyCount=this.list[n].replyCount=this.current.replies.length)}),a.on("refreshOnce",async l=>{if(l){this.current.once=l;return}let n=this,s=window.url+"/t/"+this.current.id;$.get(s+"?p=1").then(r=>{if(r.search("\u4F60\u8981\u67E5\u770B\u7684\u9875\u9762\u9700\u8981\u5148\u767B\u5F55")>-1)return console.log("\u5237\u65B0once\u65F6\u6CA1\u6709\u6743\u9650");{let m=r.match(/var once = "([\d]+)";/);m&&m[1]&&(n.current.once=m[1])}})});let e=location.href.match(/t\/([\d]+)/);e&&this.showDetail({id:e[1]},null,$(document.body),document.documentElement.outerHTML)},mounted(){},methods:{removeMsg(o){let t=this.msgList.findIndex(e=>e.id===o);t>-1&&this.msgList.splice(t,1)},getReplyInfo(o){if(!o)return;let t=i=>{let V=i.indexOf('">');if(V>-1){let f=i.substring(0,V);r.find(_=>_===f)||r.push(f)}},e=/@<a href="\/member\/[\s\S]+?<\/a>[\s]+#([\d]+)/g,l=/@<a href="\/member\/([\s\S]+?)<\/a>/g,s=[...o.matchAll(e)],r=[],h=-1;s.length&&(h=Number(s[0][1]));let d=[...o.matchAll(l)];return d.length>1&&d.map(i=>{t(i[1])}),d.length===1&&t(d[0][1]),{users:r,floor:h}},findChildren(o,t){o.children=[];for(let e=0;e<t.length;e++){let l=t[e];if(l.replyFloor===-1&&l.replyUsers.length===0)continue;let n=t.slice(e+1);if(l.replyFloor===o.index&&l.replyUsers[0]===o.username){o.children.push(this.findChildren(l,n));continue}if(l.username===o.username)break;l.replyUsers.length===1&&l.replyUsers[0]===o.username&&o.children.push(this.findChildren(l,n))}return o},getNestedList(o,t){o.map((e,l,n)=>{let s=n.slice(l+1);l===0?t.push(this.findChildren(e,s)):e.replyUsers.length===0&&e.replyFloor===-1&&t.push(this.findChildren(e,s))})},parseReply(o,t){let e=[];o.forEach((l,n)=>{if(!l.id)return;let s={thankCount:0,isThanked:!1,isOp:!1,id:""},r=l.querySelector(".reply_content");s.reply_content=r.innerHTML,s.reply_text=r.innerText;let{users:h,floor:m}=this.getReplyInfo(s.reply_content);s.replyUsers=h,s.replyFloor=m;let d=l.querySelector(".ago");s.date=d.innerText;let i=l.querySelector("strong a");s.username=i.innerText;let V=l.querySelector("td img");s.avatar=V.src;let f=l.querySelector(".no");s.index=Number(f.innerText);let _=l.querySelector(".thank_area");if(_){let u=_.id;s.id=u.replace("thank_area_",""),s.isThanked=_.classList.contains("thanked")}let c=l.querySelector(".small");c&&(s.thankCount=Number(c.innerText)),l.querySelector(".op")&&(s.isOp=!0),e.push(s)}),w.push({i:t,replyList:e})},getOtherPage(o,t){let e=this;return new Promise(l=>{$.get(o).then(n=>{let s=n.match(/<body[^>]*>([\s\S]+?)<\/body>/g),h=$(s[0]).find("#Main .box")[1].querySelectorAll(".cell");h=Array.from(h),e.parseReply(h.slice(2),t),l(!0)})})},getAllReply(){let o=w.sort((e,l)=>e.i-l.i).reduce((e,l)=>(e=e.concat(l.replyList),e),[]);this.current.replies=o;let t=this.list.findIndex(e=>e.id===this.current.id);t>-1&&(this.list[t].replyCount=o.length),this.current.replyCount=o.length,setTimeout(()=>{let e=[];this.getNestedList(JSON.parse(JSON.stringify(o)),e),this.current.nestedReplies=e})},async showDetail(o,t,e,l){if(t){let c=t.target||t.srcElement;if(c.nodeName.toLocaleLowerCase()==="a"){t.preventDefault();let u=c.innerText.match(/t\/([\d]+)/);u&&(o={id:u[1]})}}w=[],this.current=JSON.parse(JSON.stringify(o)),this.current.isFavorite=!1,this.current.isThanked=!1,this.current.once="",this.current.replies=[],this.current.nestedReplies=[],this.current.clickCount=0,this.current.collectCount=0,this.current.thankCount=0,this.show=!0,this.loading=!0;let n=this,s=window.url+"/t/"+o.id;window.history.pushState({},0,"/t/"+o.id);let r=[];if(!e){let c=await fetch(s+"?p=1");if(c.redirected)return a.emit("msg",{type:"error",text:"\u6CA1\u6709\u6743\u9650"}),n.loading=!1;if(l=await c.text(),l.search("\u4F60\u8981\u67E5\u770B\u7684\u9875\u9762\u9700\u8981\u5148\u767B\u5F55")>-1)return a.emit("msg",{type:"error",text:"\u4F60\u8981\u67E5\u770B\u7684\u9875\u9762\u9700\u8981\u5148\u767B\u5F55"}),n.loading=!1;let u=l.match(/<body[^>]*>([\s\S]+?)<\/body>/g);e=$(u[0])}if(!n.current.content_rendered){let c=e.find(".topic_content");c.length&&(n.current.content_rendered=c.html());let p=e.find(".header h1");p.length&&(n.current.title=p.html(),p.remove());let u=e.find(".header a:eq(2)");u.length&&(n.current.nodeUrl=u[0].href,n.current.node=u.text());let g=e.find(".header a:eq(5)");g.length&&(n.current.username=g.text(),n.current.date=g.next().text());let N=e.find(".header .fr img");N.length&&(n.current.avatar=N[0].src)}let h=e.find(".subtle");n.current.subtlesHtml=`
        <div class="subtlesHtml">${Array.from(h).reduce((c,p)=>(c+=`<div class="subtle">${p.innerHTML}</div>`,c),"")}</div>
        `;let m=l.match(/var once = "([\d]+)";/);m&&m[1]&&(n.current.once=m[1]);let d=e.find(".topic_buttons");if(d.length){let c=d.find(".tb:first");c&&c.length&&(n.current.isFavorite=c[0].innerText==="\u53D6\u6D88\u6536\u85CF"),d.find("#topic_thank .tb").length||(n.current.isThanked=!0)}let i=e.find(".header small.gray");if(i.length){let u=[...i.text().matchAll(/([\d]+)[\s]*次点击/g)];u.length&&(n.current.clickCount=Number(u[0][1]))}if(e.find(".topic_stats").length){let p=[...text.matchAll(/([\d]+)[\s]*人收藏/g)];p.length&&(n.current.collectCount=Number(p[0][1]));let g=[...text.matchAll(/([\d]+)[\s]*人感谢/g)];g.length&&(n.current.thankCount=Number(g[0][1]))}if(e.find("#no-comments-yet").length){this.loading=!1;return}let _=e.find("#Main .box")[1].querySelectorAll(".cell");if(_=Array.from(_),_[1].id)n.parseReply(_.slice(1),0),n.getAllReply(),this.loading=!1;else{n.parseReply(_.slice(2),0);let c=_[1].querySelectorAll("a");console.log(c),c.forEach((p,u)=>{u!==0&&r.push(n.getOtherPage(s+"?p="+(u+1),u))}),Promise.allSettled(r).then(p=>{p.filter(u=>u.status==="fulfilled").map(u=>u.value[0]),n.getAllReply(),this.loading=!1})}}}},Ct={class:"posts"},Et={class:"msgs"};function xt(o,t,e,l,n,s){const r=Vue.resolveComponent("Post"),h=Vue.resolveComponent("PostDetail"),m=Vue.resolveComponent("Msg");return Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[Vue.createElementVNode("div",Ct,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(n.list,d=>(Vue.openBlock(),Vue.createBlock(r,{onClick:i=>s.showDetail(d,i),post:d},null,8,["onClick","post"]))),256))]),Vue.createVNode(h,{modelValue:n.show,"onUpdate:modelValue":t[0]||(t[0]=d=>n.show=d),post:n.current,loading:n.loading},null,8,["modelValue","post","loading"]),Vue.createElementVNode("div",Et,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(n.msgList,d=>(Vue.openBlock(),Vue.createBlock(m,{key:d.id,type:d.type,text:d.text,onClose:i=>s.removeMsg(d.id)},null,8,["type","text","onClose"]))),128))])],64)}var Tt=k(Nt,[["render",xt]]);window.win().user||(window.win().user={username:"zyronon",avatar:"https://cdn.v2ex.com/avatar/3e59/ebe1/250936_xlarge.png?m=1657398354"});document.head.appendChild(document.createElement("base")).target="_blank";window.url=location.host;let B=Vue.createApp(Tt);B.config.unwrapInjectedRef=!0;B.mount("#app");
//# sourceMappingURL=index.53a3a17a.js.map



    })

    let $section = document.createElement('section')
    $section.id = 'app'

    let box = $('#Wrapper #Main .box:first')
    let href = location.href
    let r = href.match(/t\/([\d]+)/)
    if (r) {
        box.after($section)
    } else {
        box.css({ background: 'transparent' })
        let wrapper = box.find('.item:first')
        wrapper.after($section)

        let list = []
        let apiList = []
        let listItemNode = document.querySelectorAll('.item')
        // listItemNode = Array.from(listItemNode)
        // listItemNode.slice(1, 5).forEach(itemNode => {
        listItemNode.forEach(itemNode => {
            let item = { replies: [] }
            let item_title = itemNode.querySelector('.item_title a')
            let href = item_title.href
            item.id = href.substring(href.indexOf('/t/') + 3, href.indexOf('#'))
            item.title = item_title.innerText

            let topic_info = itemNode.querySelector('.topic_info')
            let userNode = topic_info.querySelector('strong a')
            item.username = userNode.innerText
            let timeNode = itemNode.querySelector('.topic_info span')
            item.date = timeNode.innerText
            let tagNode = topic_info.querySelector('.node')
            item.node = tagNode.innerText
            let countNode = itemNode.querySelector('.count_livid')
            item.replyCount = countNode ? countNode.innerText : 0
            itemNode.remove()

            let url =location.origin+ '/api/topics/show.json?id=' + item.id
            console.log(url)
            apiList.push($.get(url))
            list.push(item)
        })
        window.win().postList = list
        // console.log(list)

        let count = 0

        async function sleep(time) {
            return new Promise(resolve => {
                console.log('等待vue加载完成,第' + count + '次', Date.now())
                setTimeout(resolve, time)
            })
        }
        Promise.allSettled(apiList).then(
            async (results) => {
                let res = results.filter((result) => result.status === "fulfilled").map(v => v.value[0])
                if (window.win().cb) {
                    window.win().cb(res)
                } else {
                    while ((!window.win().cb) && count < 20) {
                        await sleep(500)
                        count++
                    }
                    window.win().cb && window.win().cb(res)
                }
            }
        );
    }








    // 替换为 sov2ex 搜索，代码来自 v2ex-plus 扩展：https://github.com/sciooga/v2ex-plus （懒得重复造轮子了~）
    function soV2ex() {
        document.body.appendChild(document.createElement('script')).textContent = `
                var $search = $('#search')
        var searchEvents = $._data($search[0], "events" )
        var oKeydownEvent = searchEvents['keydown'][0]['handler']
        var oInputEvent = searchEvents['input'][0]['handler']
        $search.attr("placeholder","sov2ex")
        $search.unbind('keydown', oKeydownEvent)
        $search.unbind('input', oInputEvent)
        $search.on('input', function(e) {
            oInputEvent(e)
            $('.search-item:last').attr('href', 'https://www.sov2ex.com/?q=' + $search.val()).text('sov2ex ' +$search.val());
        })
        $search.keydown(function(e) {
            if (e.code == 'Enter' || e.code == 'NumpadEnter' || e.keyCode === 13) {
                if ($('.search-item:last').is('.active')) {
                    $(this).val($(this).val().replace(/[#%&]/g,""));//用户输入不能包含特殊字符#%&
                    window.open("https://www.sov2ex.com/?q=" + $(this).val());
                    return 0
                }
            }
            oKeydownEvent(e)
        })
        `;
    }

    // soV2ex()


    // 自动签到（后台）
    function qianDao() {
        let timeNow = new Date().getUTCFullYear() + '/' + (new Date().getUTCMonth() + 1) + '/' + new Date().getUTCDate() // 当前 UTC-0 时间（V2EX 按这个时间的）
        if (location.pathname == '/') { //                               在首页
            let qiandao = document.querySelector('.box .inner a[href="/mission/daily"]');
            if (qiandao) { //                                            如果找到了签到提示
                qianDao_(qiandao, timeNow); //                           后台签到
            } else if (document.getElementById('gift_v2excellent')) { // 兼容 [V2ex Plus] 扩展
                document.getElementById('gift_v2excellent').click();
                GM_setValue('menu_clockInTime', timeNow); //             写入签到时间以供后续比较
                console.info('[V2EX 增强] 自动签到完成！')
            } else { //                                                  都没有找到，说明已经签过到了
                console.info('[V2EX 增强] 已经签过到了。')
            }
        } else { //                                                      不在首页
            let timeOld = GM_getValue('menu_clockInTime')
            if (!timeOld || timeOld != timeNow) {
                qianDaoStatus_(timeNow) //                               后台获取签到状态（并判断是否需要签到）
            }/* else { //                                                新旧签到时间一致
                console.info('[V2EX 增强] 已经签过到了。')
            }*/
        }
    }


    // 后台签到
    function qianDao_(qiandao, timeNow) {
        let url = (location.origin + "/mission/daily/redeem?" + RegExp("once\\=(\\d+)").exec(document.querySelector('div#Top .tools, #menu-body').innerHTML)[0]);
        GM_xmlhttpRequest({
            url: url,
            method: 'GET',
            timeout: 5000,
            onload: function (response) {
                let html = ShowPager.createDocumentByString(response.responseText);
                //console.log(html)
                if (html.querySelector('li.fa.fa-ok-sign')) {
                    html = html.getElementById('Main').textContent.match(/已连续登录 (\d+?) 天/)[0];
                    GM_setValue('menu_clockInTime', timeNow); // 写入签到时间以供后续比较
                    console.info('[V2EX 增强] 自动签到完成！')
                    if (qiandao) {
                        qiandao.textContent = `自动签到完成！${html}`;
                        qiandao.href = 'javascript:void(0);';
                    }
                } else {
                    GM_notification({ text: '自动签到失败！请访问 V2EX 首页试试。\n如果持续几天都签到失败，请联系作者解决！', timeout: 4000, onclick() { window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', { active: true, insert: true, setParent: true }); window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/424246/feedback', { active: true, insert: true, setParent: true }); } });
                    console.warn('[V2EX 增强] 自动签到失败！请访问 V2EX 首页试试。如果持续几天都签到失败，请联系作者解决！')
                    if (qiandao) qiandao.textContent = '自动签到失败！请尝试手动签到！';
                }
            }
        });
    }


    // 后台获取签到状态（并判断是否需要签到）
    function qianDaoStatus_(timeNow) {
        GM_xmlhttpRequest({
            url: 'https://www.v2ex.com/mission/daily',
            method: 'GET',
            timeout: 5000,
            onload: function (response) {
                //let html = ShowPager.createDocumentByString(response.responseText);
                let s = response.responseText.match(/<body[^>]*>([\s\S]+?)<\/body>/g)
                let body = $(s[0])
                if (body.find('input[value^="领取"]').length) { //     还没有签到...
                    qianDao_(null, timeNow); //                          后台签到
                } else { //                                              已经签到了...
                    console.info('[V2EX 增强] 已经签过到了。')
                    GM_setValue('menu_clockInTime', timeNow); //         写入签到时间以供后续比较
                }
            }
        });
    }


    // 链接转图片，修改自：https://greasyfork.org/scripts/14182
    function linksToImgs() {
        let links = document.links;
        Array.from(links).forEach(function (_this) {
            if (/^https.*\.(?:jpg|jpeg|jpe|bmp|png|gif)/i.test(_this.href) && !(/<img\s/i.test(_this.innerHTML))) {
                _this.innerHTML = `<img src="${_this.href}" style="max-width: 100%!important;" />`;
            }
        });
    }






</script>

</html>